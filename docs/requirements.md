# SES案件管理システム 要件定義書

## 1. システム概要

### 1.1 システム名
SES案件管理システム

### 1.2 目的
SES事業部における案件情報を効率的に管理し、Outlookメールから自動的に案件情報を抽出・登録することで、手動入力作業を削減し業務効率を向上させる。

### 1.3 対象ユーザー
- **管理者**: システム全体の管理・監督
- **営業担当者**: 案件の登録・管理・エンジニアとの連絡対応
- **エンジニア**: 案件の閲覧・営業担当者への連絡

## 2. 機能要件

### 2.1 認証・権限管理機能

#### 2.1.1 ログイン機能
- **機能概要**: ユーザーがシステムにログインする
- **入力**: メールアドレス、パスワード
- **処理**: 認証情報の検証
- **出力**: ログイン成功/失敗、ユーザー情報
- **権限**: 全ユーザー

#### 2.1.2 ロールベースアクセス制御
- **管理者**: 全機能へのアクセス権限
- **営業**: 案件の登録・編集・削除、エンジニア連絡の管理
- **エンジニア**: 案件の閲覧、営業担当者への連絡

### 2.2 案件管理機能

#### 2.2.1 案件登録機能
- **機能概要**: 新規案件を登録する
- **入力項目**:
  - 企業名（必須）
  - 案件名（必須）
  - 案件概要（必須）
  - 必須スキル（必須）
  - 歓迎スキル
  - 最低単価・最高単価
  - 勤務地
  - 稼働開始予定日
  - リモート頻度
  - 勤務時間
  - 期間
  - 精算条件
  - 支払いサイト
  - 募集人数
  - 契約形態
  - 商流
  - 外国籍可否
  - 面談方法
  - 備考
  - メール件名
  - 受信日時
  - 参考資料
- **権限**: 管理者、営業

#### 2.2.2 案件編集機能
- **機能概要**: 既存案件の情報を編集する
- **処理**: 案件情報の更新、更新日時の記録
- **権限**: 管理者、営業

#### 2.2.3 案件削除機能
- **機能概要**: 不要な案件を削除する
- **処理**: 確認ダイアログ表示後、案件データの削除
- **権限**: 管理者、営業

#### 2.2.4 案件コピー機能
- **機能概要**: 既存案件をベースに新規案件を作成する
- **処理**: 元案件の情報をコピーし、新規案件として登録
- **権限**: 管理者、営業

#### 2.2.5 案件ステータス管理
- **ステータス種別**:
  - 募集中（recruiting）
  - 提案中（proposing）
  - 成約済（contracted）
  - 終了（ended）

### 2.3 メール自動解析機能

#### 2.3.1 LLMメール解析
- **機能概要**: LLM（Large Language Model）を使用した高精度な案件情報抽出
- **対応モデル**: Phi-3-mini-4k-instruct-q4
- **処理フロー**:
  1. メール内容の入力
  2. LLMサーバーへのAPI呼び出し
  3. 構造化データの抽出
  4. フォームへの自動入力
- **信頼度表示**: 解析結果の信頼度をパーセンテージで表示

#### 2.3.2 ルールベース解析（フォールバック）
- **機能概要**: 正規表現を使用した高速解析
- **処理**: LLM解析失敗時の自動切り替え
- **抽出項目**: 案件名、概要、スキル、単価、勤務地、開始日等

### 2.4 Excel一括登録機能

#### 2.4.1 テンプレートダウンロード
- **機能概要**: Excel登録用テンプレートの提供
- **形式**: .xlsx形式
- **項目**: 全案件登録項目を含む

#### 2.4.2 一括インポート
- **機能概要**: Excelファイルから複数案件を一括登録
- **対応形式**: .xlsx, .xls, .csv
- **バリデーション**: 必須項目チェック、データ形式検証
- **エラーハンドリング**: 行単位でのエラー表示

### 2.5 案件検索・フィルタ機能

#### 2.5.1 キーワード検索
- **対象**: 案件名、案件概要
- **処理**: 部分一致検索

#### 2.5.2 詳細フィルタ
- **フィルタ項目**:
  - スキル（複数選択可）
  - 単価範囲（最低・最高）
  - 勤務地（複数選択可）
  - ステータス（複数選択可）
  - 開始日範囲

### 2.6 お気に入り・履歴機能

#### 2.6.1 お気に入り機能
- **機能概要**: 気になる案件をブックマーク
- **処理**: ユーザー別お気に入りリストの管理
- **権限**: 全ユーザー

#### 2.6.2 閲覧履歴機能
- **機能概要**: 閲覧した案件の履歴を記録
- **保存件数**: 最新20件
- **表示**: 日付別グループ化

### 2.7 エンジニア連絡管理機能

#### 2.7.1 営業担当者への連絡
- **機能概要**: エンジニアが営業担当者に興味・質問を伝達
- **入力項目**:
  - 連絡メッセージ（必須）
  - 参考資料URL（任意）
- **権限**: エンジニア

#### 2.7.2 連絡ステータス管理
- **ステータス種別**:
  - pending（新規連絡）
  - reviewing（書類選考中）
  - interview_scheduled（面談予定）
  - interview_completed（面談完了）
  - accepted（採用決定）
  - rejected（不採用）
  - withdrawn（辞退）

#### 2.7.3 営業対応機能
- **機能概要**: 営業担当者がエンジニア連絡に対応
- **処理**:
  - ステータス変更
  - 面談日時設定
  - フィードバック入力
  - 営業メモ記録
- **権限**: 管理者、営業

### 2.8 ダッシュボード機能

#### 2.8.1 管理者・営業用ダッシュボード
- **統計情報**:
  - 総案件数
  - 募集中案件数
  - 成約案件数
  - 平均単価
  - 総連絡数
  - 新規連絡数
  - 選考中数
  - 面談予定数
  - 採用決定数
- **最近の連絡**: エンジニアからの連絡一覧
- **最近の案件**: 新規登録案件一覧

#### 2.8.2 エンジニア用ダッシュボード
- **統計情報**:
  - 総連絡数
  - 営業対応待ち数
  - 選考中数
  - 面談予定数
  - 採用決定数
- **連絡状況**: 営業担当者との連絡状況一覧
- **プロフィール**: 基本情報・スキル表示

### 2.9 参考資料管理機能

#### 2.9.1 資料登録
- **機能概要**: 案件に関連する資料を登録
- **対応形式**: ドキュメント、画像、リンク
- **入力項目**: 資料名、URL、種別

#### 2.9.2 資料表示・削除
- **機能概要**: 登録済み資料の表示・削除
- **権限**: 編集権限に準拠

## 3. 非機能要件

### 3.1 性能要件
- **レスポンス時間**: 一般的な操作は3秒以内
- **LLM解析**: 30秒以内（タイムアウト設定）
- **同時接続**: 50ユーザー

### 3.2 可用性要件
- **稼働率**: 99%以上
- **メンテナンス**: 月1回、深夜時間帯

### 3.3 セキュリティ要件
- **認証**: メールアドレス・パスワード認証
- **データ保護**: ローカルストレージ暗号化
- **アクセス制御**: ロールベース権限管理

### 3.4 互換性要件
- **ブラウザ**: Chrome, Firefox, Safari, Edge（最新版）
- **OS**: Windows, macOS, Linux
- **モバイル**: レスポンシブデザイン対応

### 3.5 保守性要件
- **コード品質**: TypeScript使用、ESLint準拠
- **モジュール化**: コンポーネント単位での分割
- **ドキュメント**: コード内コメント、README

## 4. システム構成

### 4.1 フロントエンド
- **フレームワーク**: React 18
- **言語**: TypeScript
- **スタイリング**: Tailwind CSS
- **アイコン**: Lucide React
- **ビルドツール**: Vite

### 4.2 バックエンド（想定）
- **LLMランタイム**: llama.cpp
- **メール連携**: Microsoft Outlook
- **データ管理**: Excel/VBA

### 4.3 開発環境
- **実行環境**: WebContainer（ブラウザ内Node.js）
- **コード品質**: ESLint
- **バージョン管理**: Git

## 5. データ設計

### 5.1 案件データ（Case）
```typescript
interface Case {
  id: string;                    // 案件ID
  companyName: string;           // 企業名
  name: string;                  // 案件名
  overview: string;              // 案件概要
  requiredSkills: string[];      // 必須スキル
  preferredSkills: string[];     // 歓迎スキル
  rateMin: number;              // 最低単価
  rateMax: number;              // 最高単価
  workLocation: string;          // 勤務地
  remoteFrequency: string;       // リモート頻度
  developmentEnvironment: string[]; // 開発環境
  period: string;                // 期間
  settlementConditions: string;  // 精算条件
  paymentTerms: string;          // 支払いサイト
  recruitmentCount: number;      // 募集人数
  contractType: string;          // 契約形態
  businessFlow: string;          // 商流
  foreignNationalAllowed: boolean; // 外国籍可否
  interviewMethod: string;       // 面談方法
  expectedStartDate: string;     // 稼働開始予定日
  workHours: string;            // 勤務時間
  notes: string;                // 備考
  emailSubject: string;         // メール件名
  receivedAt: string;           // 受信日時
  status: 'recruiting' | 'proposing' | 'contracted' | 'ended';
  createdAt: string;            // 作成日時
  updatedAt: string;            // 更新日時
  createdBy: string;            // 作成者ID
  assignedTo?: string;          // 担当者ID
  referenceMaterials?: ReferenceMaterial[]; // 参考資料
  imageUrl?: string;            // 案件画像URL
}
```

### 5.2 ユーザーデータ（User）
```typescript
interface User {
  id: string;                   // ユーザーID
  name: string;                 // 氏名
  email: string;                // メールアドレス
  role: 'admin' | 'sales' | 'engineer'; // ロール
  department: string;           // 部署
  favorites: string[];          // お気に入り案件ID
  viewHistory: ViewHistoryItem[]; // 閲覧履歴
  applications: Application[];   // 連絡履歴
  skills: string[];             // スキル
  experience: number;           // 経験年数
}
```

### 5.3 連絡データ（Application）
```typescript
interface Application {
  id: string;                   // 連絡ID
  caseId: string;              // 案件ID
  userId: string;              // ユーザーID
  appliedAt: string;           // 連絡日時
  status: 'pending' | 'reviewing' | 'interview_scheduled' | 
          'interview_completed' | 'accepted' | 'rejected' | 'withdrawn';
  message: string;             // 連絡メッセージ
  resumeUrl?: string;          // 参考資料URL
  notes?: string;              // 営業メモ
  interviewDate?: string;      // 面談日時
  feedback?: string;           // フィードバック
}
```

## 6. 画面設計

### 6.1 画面一覧
1. **ログイン画面**: ユーザー認証
2. **ダッシュボード**: 統計情報・最新情報表示
3. **案件一覧画面**: 案件の一覧表示・操作
4. **案件詳細画面**: 案件の詳細情報表示
5. **案件登録・編集画面**: 案件の登録・編集
6. **案件検索画面**: 詳細検索・フィルタ
7. **お気に入り画面**: お気に入り案件一覧
8. **閲覧履歴画面**: 閲覧履歴一覧
9. **連絡状況管理画面**: エンジニア連絡の管理

### 6.2 画面遷移
- **共通ヘッダー**: ユーザー情報、ログアウト
- **サイドナビゲーション**: 各機能への遷移
- **モーダル**: 案件詳細、連絡送信、ステータス管理

## 7. 外部システム連携

### 7.1 LLMサーバー連携
- **プロトコル**: HTTP/HTTPS
- **API形式**: OpenAI互換REST API
- **エンドポイント**: `/v1/chat/completions`
- **認証**: APIキー（環境変数）

### 7.2 メールシステム連携
- **対象**: Microsoft Outlook
- **連携方法**: コピー&ペースト
- **データ形式**: プレーンテキスト

## 8. 運用要件

### 8.1 バックアップ
- **対象**: ローカルストレージデータ
- **頻度**: ユーザー操作時の自動保存
- **保存先**: ブラウザローカルストレージ

### 8.2 ログ管理
- **対象**: エラーログ、操作ログ
- **出力先**: ブラウザコンソール
- **保存期間**: セッション中

### 8.3 監視
- **対象**: システム稼働状況、エラー発生状況
- **方法**: ブラウザ開発者ツール

## 9. 制約事項

### 9.1 技術的制約
- **実行環境**: WebContainer（ブラウザ内実行）
- **データ永続化**: ローカルストレージのみ
- **ファイルアップロード**: URL参照のみ
- **外部API**: CORS制約あり

### 9.2 機能的制約
- **ユーザー管理**: 固定ユーザー（拡張可能）
- **データ共有**: 同一ブラウザ内のみ
- **リアルタイム通信**: 非対応

## 10. 今後の拡張予定

### 10.1 機能拡張
- **データベース連携**: PostgreSQL, MongoDB等
- **リアルタイム通信**: WebSocket対応
- **通知機能**: メール・プッシュ通知
- **レポート機能**: 統計レポート生成
- **API提供**: 外部システム連携用API

### 10.2 技術的改善
- **PWA対応**: オフライン機能
- **モバイルアプリ**: React Native版
- **マイクロサービス化**: 機能別サービス分割
- **CI/CD**: 自動テスト・デプロイ

---

**文書作成日**: 2024年2月3日  
**作成者**: SES事業部システム開発チーム  
**バージョン**: 1.0